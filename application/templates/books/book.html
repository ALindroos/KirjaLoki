{% extends "layout.html" %}

{% block body %}

 <h2>{{ book.title }}<br>({{ book.author }})</h2>
 <br>
 <h3>Kuvaus:</h3>
 <div class="card bg-light">
      <div class="card-body">
            {{ book.description }}
      </div>
 </div>
 


 <h3>Käyttäjien merkintöjä:</h3>

 <ul class=list-group>
     {% for note in book.book_notes %}
      <li class=list-group-item>{{ note.note }}</li>  
     {% endfor %}
 </ul>
 <br>
 
 {% set vars = {'read': False} %}
 {% for readbook in current_user.read_books %}
      {% if readbook.id == book.id %}
            {% if vars.update({'read':True}) %} {% endif %}
      {% endif %}      
 {% endfor %}

 

 {% if vars.read %}
      <form method="POST" action="{{ url_for('book_removeRead', book_id=book.id) }}">
            <button type="submit" class="btn btn-outline-primary">Poista luetuista kirjoista</button>
      </form>

      {% set vars = {'note': False} %}
      {% for note in book.book_notes %}
            {% if note.account_id == current_user.id %}
                  {% if vars.update({'note':True}) %} {% endif %}
            {% endif %}      
      {% endfor %}
 
      {% if vars.note %}
            <form method="GET" action="{{ url_for('note_edit', book_id=book.id) }}">
                  <button type="submit" class="btn btn-outline-primary">Muokkaa Kommenttia</button>
            </form>
      {% else %}
            <form method="GET" action="{{ url_for('note_form', book_id=book.id) }}">
                  <button type="submit" class="btn btn-outline-primary">Kirjoita kommentti</button>
            </form>
      {% endif %}
 {% else %}
      <form method="POST" action="{{ url_for('book_markRead', book_id=book.id) }}">
            <button type="submit" class="btn btn-outline-primary">Merkitse luetuksi</button>
     </form>
 {% endif %}

 


 <form method="GET" action="{{ url_for('books_edit', book_id=book.id) }}">
            <button type="submit" class="btn btn-outline-primary">Muokkaa Kirjan tietoja</button>
 </form>

 
{% endblock %} 